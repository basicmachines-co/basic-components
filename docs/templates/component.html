<!-- Hot reload script -->
{% if DEBUG %}
    {{ hotreload.script(url_for('hot-reload')) | safe }}
{% endif %}

<script>

    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.prose pre').forEach((preBlock) => {
            const codeBlock = preBlock.querySelector('code');

            // Create a wrapper for the pre block and move the pre inside it
            const wrapper = document.createElement('div');
            wrapper.classList.add('relative');
            preBlock.parentNode.insertBefore(wrapper, preBlock);
            wrapper.appendChild(preBlock);

            // Create the copy button
            const copyButton = document.createElement('button');
            copyButton.classList.add(
                'absolute', 'top-2', 'right-2', 'bg-zinc-100',
                'hover:bg-zinc-200', 'dark:bg-zinc-800',
                'dark:hover:bg-zinc-700', 'text-sm', 'px-2',
                'py-1', 'border', 'rounded-md'
            );

            // Use the custom SVG component icons in the innerHTML of the button
            copyButton.innerHTML = `<ClipboardCopy className="h-4- w-4 bg-zinc-100"/>`;

            wrapper.appendChild(copyButton);

            // Add copy functionality to the button
            copyButton.addEventListener('click', () => {
                navigator.clipboard.writeText(codeBlock.textContent).then(() => {
                    // Change the icon to a checkmark on success
                    copyButton.innerHTML = `<ClipboardCheck className="h-4- w-4 bg-zinc-100"/>`;
                    setTimeout(() => {
                        // Revert back to the original clipboard icon
                        copyButton.innerHTML = `<ClipboardCopy className="h-4- w-4 bg-zinc-100"/>`;
                    }, 2000);
                }).catch(err => console.error('Failed to copy text: ', err));
            });
        });
    });


</script>


<ComponentLayout :site_config="{{ config }}" :current_path="{{ current_path }}" :toc="{{ toc }}">

    <!--component title -->
    <h1 class="text-2xl font-semibold leading-none tracking-tight pb-4">
        {{ metadata.title }}
    </h1>

    <!--component description -->
    <p class="text-sm text-zinc-500 dark:text-zinc-400">
        {{ metadata.description }}
    </p>

    <!--component demo -->
    <div class="flex flex-col justify-center w-full">
        <Card className="border rounded-lg my-8 min-w-96 md:px-40 md:py-20">
            <CardContent>
                {% set template_path = "examples/" + metadata.component + ".html" %}
                {% include template_path %}
            </CardContent>
        </Card>
    </div>

    <!-- markdown content -->
    <article class="prose prose-zinc dark:prose-invert max-w-screen-xlg max-w-none">
        {{ content | safe }}
    </article>

    <article class="prose prose-zinc dark:prose-invert">
        <h2>Examples</h2>
    </article>

    <div class="my-8">
        {%- for example in metadata.examples -%}
            {% for name, template in example.items() %}

                <article class="prose prose-zinc dark:prose-invert">
                    <h3>{{ name }}</h3>
                </article>

                <div x-data="{ activeTab: 'Preview' }" class="my-8">
                    <!-- Tab Navigation -->
                    <nav class="flex border-b">
                        <button @click="activeTab = 'Preview'"
                                :class="{
                    'text-zinc-900 font-semibold dark:text-zinc-100 border-b-2 border-zinc-900 dark:border-zinc-100': activeTab === 'Preview',
                    'text-zinc-600 font-semibold dark:text-zinc-400': activeTab !== 'Preview'}"
                                class="py-2 px-4 text-sm transition-colors hover:text-zinc-900 dark:hover:text-zinc-100">
                            Preview
                        </button>
                        <button @click="activeTab = 'Code'"
                                :class="{
                    'text-zinc-900 font-semibold dark:text-zinc-100 border-b-2 border-zinc-900 dark:border-zinc-100': activeTab === 'Code',
                    'text-zinc-500 font-semibold dark:text-zinc-400': activeTab !== 'Code'}"
                                class="py-2 px-4 text-sm transition-colors hover:text-zinc-900 dark:hover:text-zinc-100">
                            Code
                        </button>
                    </nav>

                    <!-- Tab Content -->
                    <div class="mt-4 p-2">
                        <div x-show="activeTab === 'Preview'" class="relative">
                            <Card className="border rounded-lg my-4 min-w-96 md:px-40 md:py-20">
                                <CardContent>
                                    <!-- Include the example preview  -->
                                    {% include template %}
                                </CardContent>
                            </Card>
                        </div>

                        <div x-show="activeTab === 'Code'" class="relative">
                            <!-- Display the code content with copy button -->
                            <div class="relative">
                                <button @click="navigator.clipboard.writeText($refs.code.textContent)"
                                        class="absolute top-2 right-2 bg-zinc-100 hover:bg-zinc-200 dark:bg-zinc-800 dark:hover:bg-zinc-700 text-sm px-2 py-1 border rounded-md transition">
                                    <ClipboardCopy className="h-4- w-4 bg-zinc-100"/>
                                </button>
                                <pre class="language-html p-4 bg-zinc-50 dark:bg-zinc-900 rounded-md"><code x-ref="code" class="language-html">{{ ("docs/templates/" + template) | include_file }}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            {% endfor %}
        {%- endfor -%}
    </div>
</ComponentLayout>
